<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Tools - Privacy First</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src='https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js'></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.1/dist/browser-image-compression.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    
    <style>
        .loader { border-top-color: #3b82f6; -webkit-animation: spinner 1.5s linear infinite; animation: spinner 1.5s linear infinite; }
        @keyframes spinner { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 font-sans pb-20">

    <nav class="bg-blue-900 p-4 shadow-lg text-white sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold tracking-wider">FREE TOOLS</h1>
            <span class="text-xs bg-blue-700 px-3 py-1 rounded-full border border-blue-500">v2.0 ‚Ä¢ Offline Capable</span>
        </div>
    </nav>

    <div class="container mx-auto mt-10 p-4 grid grid-cols-1 md:grid-cols-2 gap-8">

        <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 hover:shadow-xl transition">
            <div class="flex items-center mb-4">
                <span class="bg-green-100 text-green-700 p-2 rounded-lg text-2xl mr-3">üì∑</span>
                <h2 class="text-xl font-bold text-gray-700">Image to Text (OCR)</h2>
            </div>
            <p class="text-sm text-gray-500 mb-4">Extract text from images (English & Hindi).</p>
            
            <select id="ocrLang" class="w-full mb-3 p-2 border rounded bg-gray-50 text-sm">
                <option value="eng">English</option>
                <option value="hin">Hindi (‡§π‡§ø‡§Ç‡§¶‡•Ä)</option>
            </select>

            <input type="file" id="ocrInput" accept="image/*" class="mb-4 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100" />
            
            <button onclick="runOCR()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded transition">
                Extract Text
            </button>

            <div id="ocrLoader" class="hidden flex justify-center mt-4">
                <div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-8 w-8"></div>
            </div>

            <textarea id="ocrResult" rows="4" class="w-full mt-4 p-3 border rounded-lg bg-gray-50 text-sm outline-none" placeholder="Result here..."></textarea>
        </div>

        <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 hover:shadow-xl transition">
            <div class="flex items-center mb-4">
                <span class="bg-red-100 text-red-700 p-2 rounded-lg text-2xl mr-3">üìÑ</span>
                <h2 class="text-xl font-bold text-gray-700">Merge PDFs</h2>
            </div>
            <p class="text-sm text-gray-500 mb-4">Combine multiple PDF files into one.</p>
            
            <input type="file" id="pdfInput" accept="application/pdf" multiple class="mb-4 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-red-50 file:text-red-700 hover:file:bg-red-100" />

            <button onclick="mergePDFs()" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded transition">
                Merge & Download
            </button>
            <p id="pdfStatus" class="mt-4 text-sm text-center text-gray-600 font-medium"></p>
        </div>

        <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 hover:shadow-xl transition">
            <div class="flex items-center mb-4">
                <span class="bg-yellow-100 text-yellow-700 p-2 rounded-lg text-2xl mr-3">üìâ</span>
                <h2 class="text-xl font-bold text-gray-700">Image Compressor</h2>
            </div>
            <p class="text-sm text-gray-500 mb-4">Reduce file size (MB to KB) for uploads.</p>
            
            <input type="file" id="compressInput" accept="image/*" class="mb-4 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-yellow-50 file:text-yellow-700 hover:file:bg-yellow-100" />

            <button onclick="compressImage()" class="w-full bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded transition">
                Compress Image
            </button>
            <p id="compressStatus" class="mt-4 text-sm text-center text-gray-600 font-medium"></p>
        </div>

        <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 hover:shadow-xl transition">
            <div class="flex items-center mb-4">
                <span class="bg-purple-100 text-purple-700 p-2 rounded-lg text-2xl mr-3">üì±</span>
                <h2 class="text-xl font-bold text-gray-700">QR Code Generator</h2>
            </div>
            <p class="text-sm text-gray-500 mb-4">Create QR codes for links or text.</p>
            
            <input type="text" id="qrText" placeholder="Enter URL or Text here..." class="w-full mb-4 p-2 border rounded bg-gray-50" />

            <button onclick="generateQR()" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded transition">
                Generate QR
            </button>

            <div id="qrPlaceholder" class="mt-4 flex justify-center p-4 bg-gray-50 rounded border border-dashed border-gray-300">
                <p class="text-gray-400 text-sm">QR Code will appear here</p>
            </div>
        </div>

        <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200 hover:shadow-xl transition md:col-span-2">
            <div class="flex items-center mb-4">
                <span class="bg-indigo-100 text-indigo-700 p-2 rounded-lg text-2xl mr-3">üñºÔ∏è</span>
                <h2 class="text-xl font-bold text-gray-700">Image to PDF</h2>
            </div>
            <p class="text-sm text-gray-500 mb-4">Convert JPG/PNG images into a single PDF document.</p>
            
            <input type="file" id="imgToPdfInput" accept="image/*" class="mb-4 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100" />

            <button onclick="convertImgToPdf()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded transition">
                Convert to PDF
            </button>
        </div>

    </div>

    <script>
        // --- 1. OCR LOGIC ---
        async function runOCR() {
            const file = document.getElementById('ocrInput').files[0];
            const resultArea = document.getElementById('ocrResult');
            const loader = document.getElementById('ocrLoader');
            const lang = document.getElementById('ocrLang').value;
            
            if (!file) return alert("Please upload an image.");
            loader.classList.remove('hidden');
            resultArea.value = "Processing... (Runs locally)";
            
            try {
                const { data: { text } } = await Tesseract.recognize(file, lang);
                resultArea.value = text;
            } catch (e) { resultArea.value = "Error: " + e; } 
            finally { loader.classList.add('hidden'); }
        }

        // --- 2. PDF MERGE LOGIC ---
        async function mergePDFs() {
            const files = document.getElementById('pdfInput').files;
            const status = document.getElementById('pdfStatus');
            const { PDFDocument } = PDFLib;

            if (files.length < 2) return alert("Select at least 2 PDFs.");
            status.textContent = "Merging...";
            
            const mergedPdf = await PDFDocument.create();
            for (let i = 0; i < files.length; i++) {
                const arrayBuffer = await files[i].arrayBuffer();
                const pdf = await PDFDocument.load(arrayBuffer);
                const pages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
                pages.forEach(p => mergedPdf.addPage(p));
            }
            const blob = new Blob([await mergedPdf.save()], { type: "application/pdf" });
            saveAs(blob, "merged.pdf");
            status.textContent = "Done!";
        }

        // --- 3. IMAGE COMPRESSOR LOGIC ---
        async function compressImage() {
            const file = document.getElementById('compressInput').files[0];
            const status = document.getElementById('compressStatus');
            if (!file) return alert("Select an image.");

            status.textContent = "Compressing...";
            const options = { maxSizeMB: 1, maxWidthOrHeight: 1920, useWebWorker: true };
            
            try {
                const compressedFile = await imageCompression(file, options);
                saveAs(compressedFile, "compressed-" + file.name);
                status.textContent = `Done! Reduced to ${(compressedFile.size / 1024).toFixed(2)} KB`;
            } catch (error) { status.textContent = "Error: " + error; }
        }

        // --- 4. QR CODE LOGIC ---
        function generateQR() {
            const text = document.getElementById('qrText').value;
            const container = document.getElementById('qrPlaceholder');
            if (!text) return alert("Enter text or URL.");
            
            container.innerHTML = ""; // Clear previous
            new QRCode(container, { text: text, width: 128, height: 128 });
        }

        // --- 5. IMAGE TO PDF LOGIC ---
        async function convertImgToPdf() {
            const file = document.getElementById('imgToPdfInput').files[0];
            const { PDFDocument } = PDFLib;
            if (!file) return alert("Select an image.");

            const pdfDoc = await PDFDocument.create();
            const page = pdfDoc.addPage();
            const imgBytes = await file.arrayBuffer();
            let image;

            if (file.type === 'image/jpeg') image = await pdfDoc.embedJpg(imgBytes);
            else if (file.type === 'image/png') image = await pdfDoc.embedPng(imgBytes);
            else return alert("Only JPG and PNG supported.");

            const { width, height } = image.scaleToFit(page.getWidth(), page.getHeight());
            page.drawImage(image, { x: 50, y: page.getHeight() - height - 50, width, height });

            const blob = new Blob([await pdfDoc.save()], { type: "application/pdf" });
            saveAs(blob, "image.pdf");
        }
    </script>
</body>
</html>
