<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Tools - Privacy First</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src='https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    
    <style>
        .loader { border-top-color: #3498db; -webkit-animation: spinner 1.5s linear infinite; animation: spinner 1.5s linear infinite; }
        @keyframes spinner { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 font-sans">

    <nav class="bg-indigo-700 p-4 shadow-lg text-white">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold tracking-wider">FREE TOOLS</h1>
            <span class="text-xs bg-indigo-600 px-3 py-1 rounded-full border border-indigo-400">Client-Side & Secure</span>
        </div>
    </nav>

    <div class="container mx-auto mt-10 p-4 grid grid-cols-1 md:grid-cols-2 gap-8">

        <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
            <div class="flex items-center mb-4">
                <span class="bg-green-100 text-green-700 p-2 rounded-lg text-2xl mr-3">ðŸ“·</span>
                <h2 class="text-xl font-bold text-slate-700">Image to Text (OCR)</h2>
            </div>
            <p class="text-sm text-slate-500 mb-4">Extract text from images (English & Hindi supported).</p>
            
            <select id="ocrLang" class="w-full mb-3 p-2 border rounded bg-slate-50 text-sm">
                <option value="eng">English</option>
                <option value="hin">Hindi (à¤¹à¤¿à¤‚à¤¦à¥€)</option>
            </select>

            <input type="file" id="ocrInput" accept="image/*" class="block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100 mb-4" />
            
            <button onclick="runOCR()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded transition shadow-md">
                Extract Text
            </button>

            <div id="ocrLoader" class="hidden flex justify-center mt-4">
                <div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-8 w-8"></div>
            </div>

            <textarea id="ocrResult" rows="6" class="w-full mt-4 p-3 border rounded-lg bg-slate-50 text-sm focus:ring-2 focus:ring-green-400 outline-none" placeholder="Extracted text will appear here..."></textarea>
        </div>

        <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
            <div class="flex items-center mb-4">
                <span class="bg-red-100 text-red-700 p-2 rounded-lg text-2xl mr-3">ðŸ“„</span>
                <h2 class="text-xl font-bold text-slate-700">Merge PDFs</h2>
            </div>
            <p class="text-sm text-slate-500 mb-4">Combine multiple PDF files into one single file.</p>
            
            <input type="file" id="pdfInput" accept="application/pdf" multiple class="block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-red-50 file:text-red-700 hover:file:bg-red-100 mb-4" />

            <button onclick="mergePDFs()" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded transition shadow-md">
                Merge & Download
            </button>
            
            <p id="pdfStatus" class="mt-4 text-sm text-center text-slate-600 font-medium"></p>
        </div>

    </div>

    <footer class="mt-10 text-center text-slate-400 text-sm pb-8">
        <p>Your Data never leaves your device.</p>
    </footer>

    <script>
        // --- OCR LOGIC ---
        async function runOCR() {
            const fileInput = document.getElementById('ocrInput');
            const resultArea = document.getElementById('ocrResult');
            const loader = document.getElementById('ocrLoader');
            const lang = document.getElementById('ocrLang').value;
            
            if (fileInput.files.length === 0) return alert("Please upload an image first.");

            const file = fileInput.files[0];
            loader.classList.remove('hidden');
            resultArea.value = "Processing... (This runs on your CPU)";

            try {
                const { data: { text } } = await Tesseract.recognize(
                    file,
                    lang, 
                    { logger: m => console.log(m) }
                );
                resultArea.value = text;
            } catch (error) {
                resultArea.value = "Error: " + error.message;
            } finally {
                loader.classList.add('hidden');
            }
        }

        // --- PDF MERGE LOGIC ---
        async function mergePDFs() {
            const fileInput = document.getElementById('pdfInput');
            const status = document.getElementById('pdfStatus');
            const { PDFDocument } = PDFLib;

            if (fileInput.files.length < 2) return alert("Please select at least 2 PDF files.");

            status.textContent = "Processing...";
            status.className = "mt-4 text-sm text-center text-blue-600 font-medium";
            
            try {
                const mergedPdf = await PDFDocument.create();

                for (let i = 0; i < fileInput.files.length; i++) {
                    const file = fileInput.files[i];
                    const arrayBuffer = await file.arrayBuffer();
                    const pdf = await PDFDocument.load(arrayBuffer);
                    const copiedPages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
                    copiedPages.forEach((page) => mergedPdf.addPage(page));
                }

                const pdfBytes = await mergedPdf.save();
                const blob = new Blob([pdfBytes], { type: "application/pdf" });
                saveAs(blob, "merged-document.pdf");
                status.textContent = "Success! Download started.";
                status.className = "mt-4 text-sm text-center text-green-600 font-bold";
            } catch (err) {
                console.error(err);
                status.textContent = "Error merging files.";
                status.className = "mt-4 text-sm text-center text-red-600 font-bold";
            }
        }
    </script>
</body>
</html>
